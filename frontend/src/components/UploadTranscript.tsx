import React,{useState}from'react';import{uploadTranscript,uploadTranscriptPdf}from'../api';type Props={onLoaded:(t:any,extra?:any)=>void};export default function UploadTranscript({onLoaded}:Props){const[file,setFile]=useState<File|null>(null);const[loading,setLoading]=useState(false);const[mode,setMode]=useState<'json'|'pdf'>('json');async function handleUpload(){if(!file)return;setLoading(true);try{const res=mode==='json'?await uploadTranscript(file):await uploadTranscriptPdf(file);if(mode==='json')onLoaded(res.transcript);else onLoaded(res.transcript,{audit:res.audit,planned_terms:res.planned_terms});}finally{setLoading(false);}}return(<div className='card'><h3>1) Upload Transcript</h3><div style={{display:'flex',gap:8,marginBottom:8}}><button className='btn'onClick={()=>setMode('json')}disabled={mode==='json'}>JSON Mode</button><button className='btn'onClick={()=>setMode('pdf')}disabled={mode==='pdf'}>PDF Mode</button></div><input type='file'accept={mode==='json'?'application/json':'application/pdf'}onChange={e=>setFile(e.target.files?.[0]||null)}/><button className='btn'onClick={handleUpload}disabled={!file||loading}>{loading?'Uploadingâ€¦':'Upload'}</button><p style={{opacity:.7}}>JSON: use backend/data/transcript.sample.json. PDF: use a degree audit export.</p></div>);}

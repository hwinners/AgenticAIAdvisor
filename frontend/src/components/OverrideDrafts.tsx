import React,{useState}from'react';import{overrideDraft,explain}from'../api';type Props={student:any,planned_terms:any[]|null,requirements:any[]|null};export default function OverrideDrafts({student,planned_terms,requirements}:Props){const next=planned_terms?.[0];const[drafts,setDrafts]=useState<string[]>([]);const[explanation,setExplanation]=useState<string>('');if(!next||!requirements)return null;async function genOverride(course:string){const res=await overrideDraft({student,course,term:next.term,reason:'Section full',evidence:'Required for on-time progression'});setDrafts(d=>[...d,res.draft]);}async function why(course:string){const res=await explain({planned_terms,requirements,course,term:next.term});setExplanation(res.explanation);}return(<div className='card'><h3>5) Policy Automation & Explainability</h3><p>Next term: <strong>{next.term}</strong></p><div style={{display:'flex',gap:8,flexWrap:'wrap'}}>{next.courses.map((c:string)=>(<div key={c}className='card'style={{minWidth:220}}><strong>{c}</strong><div style={{display:'flex',gap:8,marginTop:8}}><button className='btn'onClick={()=>genOverride(c)}>Draft Override</button><button className='btn'onClick={()=>why(c)}>Why here?</button></div></div>))}</div>{drafts.length>0&&(<><h4>Generated Drafts</h4>{drafts.map((d,i)=>(<pre key={i}>{d}</pre>))}</>)}{explanation&&(<><h4>Explanation</h4><pre>{explanation}</pre></>)}</div>);}
